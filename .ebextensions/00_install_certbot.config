# .ebextensions/00_install_certbot.config
container_commands:
  00_install_deps:
    command: "sudo dnf install python3 augeas-libs -y"
    ignoreErrors: true
  10_create_venv:
    command: "sudo python3 -m venv /opt/certbot"
    ignoreErrors: true
  20_update_pip:
    command: "sudo /opt/certbot/bin/pip install --upgrade pip"
    ignoreErrors: true
  30_install_certbot:
    command: "sudo /opt/certbot/bin/pip install certbot certbot-nginx"
    ignoreErrors: true
  40_link_certbot:
    command: "sudo ln -s /opt/certbot/bin/certbot /usr/bin/certbot"
    ignoreErrors: true
  50_fix_nginx_config:
    command: "sudo sed -i 's/server_names_hash_bucket_size 64;/server_names_hash_bucket_size 128;/' /etc/nginx/nginx.conf"
    ignoreErrors: true
